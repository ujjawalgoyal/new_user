

//= ==============================Load Modules Start========================

const express = require("express");
const bodyParser = require("body-parser");// parses information from POST
const appUtils = require("../util");
const methodOverride = require("method-override");

module.exports = function (app, env) {
  app.use(bodyParser.urlencoded({
    extended: true,
  }));
  // parses application/json bodies
  app.use(bodyParser.json());
  // use queryString lib to parse urlencoded bodies
  // parses application/x-www-form-urlencoded bodies
  app.use(methodOverride((req, res) => {
    if (req.body && typeof req.body === "object" && "_method" in req.body) {
      // look in urlencoded POST bodies and delete it
      const method = req.body._method;
      delete req.body._method;
      return method;
    }
  }));
  if (!app.locals.rootDir) {
    // throw error
  }
  app.use((req, res, next) => {
    appUtils.setHeadersForCrossDomainIssues(res);
    next();
  });
  /**
   * add swagger to our project
   */
  app.use("/apiDocs", express.static(`${app.locals.rootDir}/swagger/dist`));
};

