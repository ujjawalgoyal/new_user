//= ========================= Load Modules Start =======================

const _ = require("lodash");
const placeRouter = require("express").Router();
const resHndlr = require("../resHandler");
const placesFacade = require("../places/placesFacade");
const middleware = require("../middleware");

//= =============================== Load module end =====================
// Route to create a place
placeRouter.route("/places/create")
    .post([middleware.authentication.autntctTkn,
    middleware.validators.validateCreatePlace], (req, res) => {
        const params = _.pick(req.body, ["title", "tag_line", "description", "email", "phone_no", "location", "category_ids"]);
        params.business_id = req.user.uid;
        placesFacade.createPlaces(params)
            .then((result) => {
                resHndlr.sendSuccess(res, result);
            })
            .catch((err) => {
                resHndlr.sendError(res, err);
            });
    });


//= =============================== Export route ================================
module.exports = placeRouter;
